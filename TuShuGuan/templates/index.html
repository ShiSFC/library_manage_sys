{% extends 'base_reader.html' %}
{% load my_tags %}
{% block book_list %}
<form action="{% url 'index_query' %}" method="post"  style="float:left;">
{% csrf_token %}
<p>
<input type="text" placeholder="可输入书名、作者、出版社" name="title">
<input type="submit" class="btn btn-info" value="Search">
</p>
</form>
<table class="table table-hover">
    <tr>
        <th>序号</th>
        <th>书名</th>
        <th>作者</th>
        <th>出版社</th>
        <th>剩余数量</th>
        <th style="text-align: center">操作</th>
    </tr>
    {% for book in book_list %}
    <tr>
        <td>{{ forloop.counter }}</td>
        <td>{{ book.title }}</td>
        <td>
            {% for author in book.author.all %}
                {{ author.name }}
            {% endfor %}
        </td>
        <td>{{ book.publish.name }}</td>
        <td>{{ book.totalCount|my_filter:book.borrowCount }}</td>
        <td style="text-align: center">
            <a href="{% url 'book_reader_detail' %}?id={{ book.id }}" style="margin-right:5px"><button class="btn-info">详情</button></a>
        </td>
    </tr>
    {% endfor %}
</table>
<nav aria-label="Page navigation" style="position: fixed;bottom: 5px;right:50%">
    <ul class="pagination">
        {% if book_list.has_previous %}
            <li><a href="{% url 'index' %}?page={{ book_list.previous_page_number }}">上页<span class="sr-only">(current)</span></a></li>
        {% else %}
            <li class="disabled"><a href="#">上页</a></li>
        {% endif %}
        {% for page in p.page_range %}
            {% if page_number == page %}
                <li><a href="{% url 'index' %}?page={{ page }}" style="color:red">{{ page }}<span class="sr-only">(current)</span></a></li>
            {% else %}
                <li><a href="{% url 'index' %}?page={{ page }}">{{ page }}<span class="sr-only">(current)</span></a></li>
            {% endif %}
        {% endfor %}
        {% if book_list.has_next %}
            <li><a href="{% url 'index' %}?page={{ book_list.next_page_number }}">下页<span class="sr-only">(current)</span></a></li>
        {% else %}
            <li class="disabled"><a href="#">下页</a></li>
        {% endif %}
    </ul>
</nav>
{% endblock %}